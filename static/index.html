<!DOCTYPE html>

<!-- 
http://peldaws.westus.cloudapp.azure.com/

Dialog not supported in firefox 


 DATE 
test audio.load 



Y range: 0~203 ,  237~439   237->236

 

if select out of bound,  should not able to crop!!!!!!!!!!

change x position 
 
remove Jcrop.gif 


 
 firefox problem
 ******************settings 
-->


<html>
	<head>
		<link rel = "stylesheet" type = "text/css" href = "css/styles.css">
		<link rel="stylesheet" type"text/css" href="css/print.css" media="print">
		
		
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.Jcrop.min.js"></script>
		<script src="http://malsup.github.com/jquery.form.js"></script>
		
		<link rel="stylesheet" href="css/jquery.Jcrop.css" type="text/css" />
		
		<script> 
		       $(document).ready(function() { 
		       	   
		           // bind 'myForm' and provide a simple callback function 
		           $('#myForm').ajaxForm({ 
		           		success: showSoundInfo
		           }); 
		           
		          
		           	$("#upload").change(function(e){
		           		document.getElementById('fileName').innerHTML = this.files[0].name;		     
		           		document.getElementById('fileSize').innerHTML = formatSize(this.files[0].size, 2);
		           		document.getElementById('lastModifyDate').innerHTML = this.files[0].lastModifiedDate;	
		           		
		           		
		           		
		           		/*var name = this.files[0].name;
		           		obj.name = name;		     
		           		var size = formatSize(this.files[0].size, 2);
		           		obj.size = size;
		           		var date = this.files[0].lastModifiedDate; 
		           		obj.date = date;
		           		*/
		           	}); 
		       });    
		</script> 
		

		<script type="text/javascript">
				
			//var getBound = "/getBounds/sp1.wav";
			var drawSound = "/drawSound/"; 
			var listSound  = "/listSounds";
			var newURL = '';	
			var obj = {
				name : 0,
				//date:0,
				//size:0,
				oriStart: 0,
				oriEnd: 0,
				   
				totalTime: 0,
				visuTime: 0,
				
				checkPitch: 1,
				minPitch:75,
				maxPitch:500,
				
				checkIntensity: 1,
				minIntensity:0,
				maxIntensity: 100,
				
				checkFormant: 1,
				checkHarmonicity: 0,
				checkPointprocess: 0,
				checkSpectogram: 0,
				checkWaveform: 0,
				selStart:0,
				selEnd: 0,
				absoluteT1 : 0,
				absoluteT2: 0,
				selT1:0,
				selT2:0,
				selY1:0,
				selY2:0
			};	
			var checkStatus = obj.checkPitch+"/"+obj.checkIntensity+"/"+obj.checkFormant;
			
		
			<!-- Jcrop functions -->
			
			
			function showSoundInfo(data){
			 obj.name = data.sound;
			 var status = data.status; 
			 //alert(status);
			 var success = "Success";
			 
			  if(status.localeCompare(success) == 0){
			  	drawSound = "/drawSound/";
			  	document.getElementById('audio').src = '';
			    getSoundInfo(); 
			   	
			  }
			  else{
			  	obj.name = '0';
			  }
			}
			
			function getSoundInfo(){
				//alert('get Sound Info '+ obj.name);
				var bound = "/getBounds/"+obj.name;
			
					$.get(bound,function(data, status){
						obj.oriStart = data.start;
						obj.oriEnd = data.end;
						
						obj.totalTime = obj.oriEnd-obj.oriStart;
						obj.visuTime = obj.totalTime;
						obj.selStart = obj.oriStart;
						obj.selEnd = obj.oriEnd;
								
					    				
						document.getElementById('timeDuration').innerHTML = formatTime(obj.totalTime);
						drawSound  = drawSound + obj.name +'/';
						 newURL = drawSound+obj.oriStart+"/"+obj.oriEnd+"/"+checkStatus;
						document.getElementById('selectNewFile').innerHTML='';
						// display new image!!!!!!!!!!!!!!!!!!!!!!!!!!!
						$('.jcrop-holder img').attr('src',newURL);
						
					    showTimes();
						displayLimitRange();
						
						//upload the sound file 
						var audio = document.getElementById('audio');
						audio.src='/play/'+obj.name;
						audio.load();
					});
			}
			
			
			function showTimes(){
				
				if(obj.selStart == 0 ){
				document.getElementById('showTimesLeft').innerHTML= '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp0';
				}
				else{
				document.getElementById('showTimesLeft').innerHTML= '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp'+ (obj.selStart).toFixed(6);
				}
				document.getElementById('showTimesRight').innerHTML= (obj.selEnd).toFixed(6);
			}
			
			
			function displayLimitRange(){			
				displayFrequency();	
						if((obj.checkPitch + obj.checkIntensity) == 0){
							document.getElementById('showIntensityRange').innerHTML= '';
							document.getElementById('showPitchRange').innerHTML= '';
							return;
						}else {
							if(obj.checkPitch == 1){
							document.getElementById('showPitchRange').innerHTML= obj.maxPitch +' Hz<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n'+obj.minPitch+' Hz';
							
							}
							else{
							document.getElementById('showPitchRange').innerHTML= '';
							}
							
							if(obj.checkIntensity == 1){
							document.getElementById('showIntensityRange').innerHTML= obj.maxIntensity +' dB<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n<br>\n&nbsp;&nbsp;&nbsp;&nbsp;'+obj.minIntensity+' dB';
							}
							else{
							document.getElementById('showIntensityRange').innerHTML= '';
							}	
						}

			}
			
			function displayFrequency(){
				 	if((obj.checkFormant+obj.checkSpectogram) == 0){
				 		document.getElementById('showHz').innerHTML= '';
						//disable the line
						
						$("#hzLine").removeClass('showHorizontal');
				 		return;
				 	}
				 	
				 	if(obj.selY1 >=236 && obj.selY1 <=439 ){
				 	
				 		document.getElementById('showHz').innerHTML= (5000-(obj.selY1-236)/202*5000).toFixed(0)+' Hz' ;
				 		$("#showHz").css({top: (126 + obj.selY1) , position: 'absolute'});
				 		$("#hzLine").addClass('showHorizontal');
				 		$("#hzLine").css({top:(116 +obj.selY1) , position :'absolute'});
				 	}
				 	
			}
			
			function changeSelectionBar(){
			
				if(obj.absoluteT1 == obj.absoluteT2){
				    $("#line2").removeClass('afterClick');
				    $("#line1").removeClass('afterClick');
				    
					if((obj.absoluteT1 > obj.selStart) && (obj.absoluteT1 < obj.selEnd) ){
					$("#line1").addClass('afterClick');
					$("#line1").css({left: (384+375/(obj.selEnd-obj.selStart)*(obj.absoluteT1-obj.selStart)),position:'absolute'});
					}
					showTimes();
					return;
			    }
			    
				var transt1;
				var transt2;
				
				if(obj.absoluteT1 >= obj.selStart){
					$("#line1").addClass('afterClick');
					transt1 = 384+375/(obj.selEnd-obj.selStart)*(obj.absoluteT1-obj.selStart);
					$("#line1").css({left: transt1 ,position:'absolute'});
				
				}else if(obj.absoluteT1 < obj.selStart){
					transt1 = 383;
					$("#line1").removeClass('afterClick');
					if(obj.absoluteT2 < obj.selStart){
						$("#line2").removeClass('afterClick');
						$("#transBox").css({ width:0});
						showTimes();
						return;
					}
				}
				
				if(obj.absoluteT2 <= obj.selEnd){
					$("#line2").addClass('afterClick');
					transt2 = 384+375/(obj.selEnd-obj.selStart)*(obj.absoluteT2-obj.selStart);
					$("#line2").css({left: transt2, position:'absolute'});
				
				}
				else if(obj.absoluteT2 > obj.selEnd){
					transt2 = 758;
					$("#line2").removeClass('afterClick');
					if(obj.absoluteT1 > obj.selEnd){
						$("#line1").removeClass('afterClick');
						$("#transBox").css({ width:0});
						showTimes();
						return;
					}
				}
				
				$("#transBox").css({left: transt1+1, width: transt2-transt1 + 0.5});
				showTimes();
			}
			
			
			function zoomoutNormal(){
			    var start = obj.selStart; 
				obj.selStart = (start +obj.visuTime/2)-obj.visuTime/2*2;
				obj.selEnd = (start +obj.visuTime/2)+obj.visuTime/2*2 ;
				 newURL = drawSound+obj.selStart+"/"+obj.selEnd+"/"+checkStatus;
				obj.visuTime = obj.visuTime*2;
				$('.jcrop-holder img').attr('src',newURL);
				
			}
			
	
			
					
	jQuery(function($){
				 
				    $("#in").click(function(){
				         //alert(obj.absoluteT1);
				         //alert(obj.visuTime);
				        if(obj.name == 0) return;
				        if(obj.visuTime/2 < 0.0009){
				    	
				    	}else{
				    	var start = obj.selStart;
				    	obj.selStart = ((start +obj.visuTime/2)-(obj.visuTime/4));
				    	obj.selEnd = ((start+obj.visuTime/2) +(obj.visuTime/4));
				    	
				    	 newURL = drawSound+obj.selStart+"/"+obj.selEnd+"/"+checkStatus;
				    	
				    	
				    	changeSelectionBar();
				    	
				    	obj.visuTime = obj.visuTime/2;
				    	$('.jcrop-holder img').attr('src',newURL);
				    	}
				    });
				    
				    //check if absoluet t1 == t2 
				    $("#out").click(function(){
				        //alert(obj.absoluteT1);
				        //alert(obj.visuTime);
				        
				       
				        if(obj.name == 0) return;
				    	if(obj.visuTime == obj.totalTime){
				    	
				    	}else if(obj.visuTime*2 >= obj.totalTime){
				    	
				    	obj.selStart = obj.oriStart;
				    	obj.selEnd = obj.oriEnd;
				    	obj.visuTime = obj.totalTime;
				    	changeSelectionBar();
				    	 newURL = drawSound+obj.oriStart+"/"+obj.oriEnd+"/"+checkStatus;
				    	$('.jcrop-holder img').attr('src',newURL);
				    	
				    	}
				    	
				        				    	
				    	else if((obj.selStart +obj.visuTime/2) > (obj.oriEnd-obj.oriStart)/2 ){
				    		if((obj.selStart +obj.visuTime/2)+obj.visuTime/2*3 <= obj.oriEnd){
				    		    zoomoutNormal();
				    		    changeSelectionBar();
				    		}else{
				    		//spare the space
				    		obj.selEnd = obj.oriEnd;
				    		obj.selStart = obj.oriEnd - obj.visuTime*2;
				    		 newURL = drawSound+obj.selStart+"/"+obj.selEnd+"/"+checkStatus;
				    		obj.visuTime = obj.visuTime*2;
				    		$('.jcrop-holder img').attr('src',newURL);
				    		changeSelectionBar();
				    		}
				    	
				    	}else if((obj.selStart +obj.visuTime/2) < (obj.oriEnd-obj.oriStart)/2 ){
				    		if((obj.selStart +obj.visuTime/2)-obj.visuTime/2*3 >= obj.oriStart){
				    		    zoomoutNormal();
				    		    changeSelectionBar(); 
				    		}else{
				    		//spare the space 
				    		obj.selStart = obj.oriStart;
				    		obj.selEnd = obj.oriStart + obj.visuTime*2;
				    		 newURL = drawSound+obj.selStart+"/"+obj.selEnd+"/"+checkStatus;
				    		obj.visuTime = obj.visuTime*2;
				    		$('.jcrop-holder img').attr('src',newURL);
				    		changeSelectionBar();
				    		}
				    		
				    	}
				    	else {
				    		zoomoutNormal();
				    		changeSelectionBar();
				    	}
				    });
				    
	
				    //change selectino bar
				    $("#all").click(function(){
				    	if(obj.name == 0) return;
				    	if(obj.name == 0) return;
				    	obj.selStart = 0;
				    	obj.selEnd = obj.oriEnd; 

				    	obj.visuTime = obj.totalTime;
				    	changeSelectionBar();
				    	 newURL = drawSound+obj.oriStart+"/"+obj.oriEnd+"/"+checkStatus ;
				    	$('.jcrop-holder img').attr('src',newURL);
				    });
				    
				   
				    $("#pitch").click(function(){
				    	if(obj.checkPitch == 1){
				    	obj.checkPitch = 0;
				    	
				    	}else{
				    	obj.checkPitch = 1;
				    	}
				    	checkStatus = obj.checkPitch+"/"+obj.checkIntensity+"/"+obj.checkFormant;
				    	if(obj.name == 0) return;
				    	displayLimitRange();
				    	if(obj.visuTime == obj.totalTime){
				    		 newURL = drawSound+obj.oriStart+"/"+obj.oriEnd+"/"+checkStatus;
				    	}else if(obj.visuTime != obj.totalTime){
				    		 newURL = drawSound + obj.selStart+"/"+(obj.selStart+obj.visuTime)+"/"+checkStatus;
				    	}	
				    	$('.jcrop-holder img').attr('src',newURL);
				    				    			    	
				    });
				    
				    $("#intensity").click(function(){
				    	if(obj.checkIntensity == 1){
				    	obj.checkIntensity = 0;
				    	}else{
				    	obj.checkIntensity = 1;
				    	}
				    	checkStatus = obj.checkPitch+"/"+obj.checkIntensity+"/"+obj.checkFormant;
				    	if(obj.name == 0) return;
				    	displayLimitRange();
				    	
				    	if(obj.visuTime == obj.totalTime){
				    		 newURL = drawSound+obj.oriStart+"/"+obj.oriEnd+"/"+checkStatus;
				    	}else if(obj.visuTime != obj.totalTime){
				    		 newURL = drawSound + obj.selStart+"/"+(obj.selStart+obj.visuTime)+"/"+checkStatus;
				    	}	
				    	$('.jcrop-holder img').attr('src',newURL);			    			    	
				    });
				    
				    $("#formant").click(function(){
				    	
				    	if(obj.checkFormant == 1){
				    	obj.checkFormant = 0;
				    	
				    	}else{
				    	obj.checkFormant = 1;
				    	
				    	}
				    	
				    	checkStatus = obj.checkPitch+"/"+obj.checkIntensity+"/"+obj.checkFormant;
				    	if(obj.name == 0) return;
				    	
				    	
				    	displayLimitRange();
				    	
				    	if(obj.visuTime == obj.totalTime){
				    		 newURL = drawSound+obj.oriStart+"/"+obj.oriEnd+"/"+checkStatus;
				    	}else if(obj.visuTime != obj.totalTime){
				    		 newURL = drawSound + obj.selStart+"/"+(obj.selStart+obj.visuTime)+"/"+checkStatus;
				    	}	
				    	
				    	$('.jcrop-holder img').attr('src',newURL);			    			    	
				    });
				    
				    $("#spectogram").click(function(){
				    	if(obj.checkSpectogram== 1){
				    	obj.checkSpectogram = 0;
				    	}else{
				    	obj.checkSpectogram = 1;
				    	}
				    	checkStatus = obj.checkPitch+"/"+obj.checkIntensity+"/"+obj.checkFormant;
				    	if(obj.name == 0) return;
				    	displayLimitRange();
				    	
				    	//change display images 
				    		    			    	
				    });
				   
			<!-- for JCROP -->
			
		    var api;

		    $('#target').Jcrop({
		      
		      onChange:   showCoords,
		      onSelect:   displayCoords,
		      onRelease:  clearCoords,
			  
		    },function(){
			  $('#target').Jcrop({ allowResize:false });
			  $('#target').Jcrop({ allowMove:false });
		      $('#cropbox').Jcrop({ trueSize: [427,487] });
		      $('#target').Jcrop({ bgOpacity:1});
		      api = this;
		      
		    });
    
		    $('#coords').on('change','input',function(e){
		       
		      var x1 = $('#x1').val(),
		          x2 = $('#x2').val(),
		          y1 = $('#y1').val(),
		          y2 = $('#y2').val();
		       
		    api.setSelect([x1,x2,y1,y2]);
		    });
		     
		    $("#sel").click(function(){
		    	//alert(obj.visuTime);
		    	
		    	if(obj.selT2 == obj.selT1){
		    	
		    	}
		    	else if( ((obj.selT2-obj.selT1)/375*obj.visuTime) < 0.0009 ){
		    		document.getElementById('info').innerHTML='Selected time duration too small.';
		    	}else{
		    	<!-- show display --> 
		    		 newURL = drawSound+obj.absoluteT1+"/"+obj.absoluteT2+"/"+checkStatus ;
		    		obj.selStart = obj.absoluteT1;
		    		obj.selEnd = obj.absoluteT2;
		    		obj.visuTime = (obj.selT2-obj.selT1)/375 * obj.visuTime;
		    		api.release();
		    		$('.jcrop-holder img').attr('src',newURL);	
		    		$("#line1").css({left: 384, position:'absolute'});
		    		$("#line2").css({left: 759, position:'absolute'});
		    		
		    		$("#transBox").css({left: 385.5, width: 373});
		    		
		    		if(obj.selStart == 0 ){
		    		document.getElementById('showTimesLeft').innerHTML= '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp0';
		    		}
		    		else{
		    		document.getElementById('showTimesLeft').innerHTML= '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp'+ (obj.selStart).toFixed(6);
		    		}
		    		document.getElementById('showTimesRight').innerHTML= (obj.selEnd).toFixed(6);
		    				    		
		    		
		    	}
		    	
		    	
		    	
		    	
		    });
		   
		    function changeTransBox(){
		    				  		
		    		if(obj.selT1 == obj.selT2){
		    	 		$("#transBox").removeClass('afterDisplay');
		    		}
		    		else{
		    			//alert(obj.selY1);
		    			//alert(obj.selY2);
		    			
		    		//fixed bug: transBox go out of bound
		    		if(obj.selT2 == 375){
		    		$("#transBox").addClass('afterDisplay');
		    		$("#transBox").css({left: obj.selT1+385.5, width: (375 -obj.selT1 - 2)});
		    		return; 			
		    		}
		    			$("#transBox").addClass('afterDisplay');
		    			$("#transBox").css({left: obj.selT1+385.5, width: (obj.selT2-obj.selT1 - 2)});
		    		
		    		}
		    		
		    		
		    };	  	
		   	
		   
		   	 	
		  	function showCoords(c){
		  	
		  	if(obj.name.localeCompare(0) == 0){
		  		api.release();
		  		return;
		  	}
		  	
		  	$("#transBox").removeClass('afterDisplay');
		  	
		  		obj.selT1 = c.x - 44;
		  		obj.selT2 = c.x2 - 44;
		  		
		  	
		  		obj.selY1 = c.y-13 ;
		  		obj.selY2 = c.y2-13 ;
		  		
		  		obj.absoluteT1 = obj.selStart +obj.selT1/375*obj.visuTime;
		  		obj.absoluteT2 = obj.selStart +obj.selT2/375*obj.visuTime;
		  		
		  		$("#line1").addClass('afterClick');
		  	
		  		if(c.x === c.x2){
		  			$("#line2").removeClass('afterClick');
		  			if(c.x < 44){
		  				api.release();
		  				$("#line1").css({left: 384, position:'absolute'});
		  				document.getElementById('selectedInfo').innerHTML='';
		  				document.getElementById('info').innerHTML='';	
		  						  				
		  				
		  			}else if(c.x > 419){
		  				api.release();
		  				$("#line1").css({left: 759, position:'absolute'});
		  				document.getElementById('selectedInfo').innerHTML='';
		  				document.getElementById('info').innerHTML='';		
		  			}else{	 
		  				document.getElementById('selectedInfo').innerHTML='';
		  				$("#line1").css({left: obj.selT1+384, position:'absolute'});
		  				
		  				document.getElementById('info').innerHTML='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selected time : '+ (obj.selStart + obj.selT1/375*obj.visuTime).toFixed(6);
		  			}
		  			
		  		}else if (c.x != c.x2){
		  			if((c.x < c.x2) && (c.x < 44)){
		  			
		  			api.release();
		  			$("#line2").addClass('afterClick');
		  			$("#line2").css({left: obj.selT2+384, position:'absolute'});
		  			$("#line1").css({left:384, position:'absolute'});
		  			obj.selT1 = 0;
		  			obj.absoluteT1 = obj.selStart ;	
		  			changeTransBox();
		  				
		  			}else if((c.x < c.x2) && (c.x2 > 419)){
		  			
		  			api.release();
		  			$("#line2").addClass('afterClick');
		  			$("#line2").css({left: 759, position:'absolute'});
		  			$("#line1").css({left:obj.selT1+384, position:'absolute'});
		  			obj.selT2 = 375;
		  			obj.absoluteT2 = obj.selEnd;
		  			changeTransBox();
		  				
		  			}
		  			else{
		  			$("#line2").addClass('afterClick');
		  			$("#line1").css({left: obj.selT1+384, position:'absolute'});
		  			$("#line2").css({left: obj.selT2+384, position:'absolute'});
	
		  			}
		  			api.release();
		  			changeTransBox();
		  		    document.getElementById('selectedInfo').innerHTML='Selected time duration : '+ ((obj.selT2-obj.selT1)/375*obj.visuTime).toFixed(6) ;
		  			document.getElementById('info').innerHTML='Start time : '+( obj.selStart +obj.selT1/375*obj.visuTime).toFixed(6) +'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End Time : '+ (obj.selStart +obj.selT2/375*obj.visuTime).toFixed(6) ;
		  			
		  			
		  		}
		  		
		  		displayFrequency();
		  	
		  	};
		  	
		  	//remove c!!!!!!!!!!!!! 
		  	function displayCoords(){	
		  		api.release();
		  		changeTransBox();
		  		
		  	};
		  	
		  	
		  	function clearCoords(){
		   		$('#coords input').val('');		   		
		  	};	
		  	
		  	
		});
		
		
		
		function formatTime(s){
			if(s == 0){
		  	 return '0 s'; 
			}
			
			var u = 60;
			var sizes = ['s', 'min', 'hr'];
			var r  = Math.floor(Math.log(s)/Math.log(u));
			return (s/Math.pow(u,r)).toPrecision(6) + ' '+sizes[r]; 
		}
		<!-- function that convert the file size -->
		function formatSize(bytes,decimals) {
			//alert('start format size '+bytes);
		   if(bytes == 0){
			return '0 Byte';
		   }
		   
		   var k = 1000;
		   var de = decimals + 1 || 3;
		   var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
		   var si = Math.floor(Math.log(bytes) / Math.log(k));
		   return (bytes / Math.pow(k, si)).toPrecision(de) + ' ' + sizes[si];
		}
				
	    function play(){
	        //alert('Start playing')
	        document.getElementById('audio').play();     
	    }
	    function getEnergy(){
	    	
	    	var energy = '/getEnergy/'+obj.name;
	    	$.get(energy,function(data, status){
	    		
	    		if(status.localeCompare('success') == 0){
	    		alert(data);
	    		
	    		
	    		}
	    	});
	    
	    }
	    
	    function getPitch(){
	    	<!-- may use prompt -->
	    	alert('show pitch, if selected time-> show pitch,  range-> show mean ')
	    }
	    
	    function countvf(){
	    	alert('display total voice frames')
	    }
	    
	    
	    
	    function getvat(){
	    	var time = prompt("Time(s)", "0.5");
	    	    
	    	    if (time != null) {
	    	        alert('show value at time , drop down?');
	    	    }
	    }
	    function getvif(){
	    	var frame = prompt("Frame number", "10");
	    	    
	    	    if (frame != null) {
	    	        alert('show value at time, drop down? ');
	    	    }
	    }
	    
	    function getlf(){
	    	alert('lowest f');
	    }
	    
	    function gethf(){
	    	alert('higest f')
	    
	    }
	    
	    function save() {
	    	
	    	if(obj.name.localeCompare(0)==0){
	    	
	    	}else{
	        window.open(newURL);
	        }
	    }
	    
	   	    
	    
	    function displayList(){
	    // retrieve the list 
			$.get(listSound,function(data,status){
	    		var size = data.files.length;
				var vals = data.files;
				var $soundList = $('#fileSelection');
			
				$soundList.empty();
				$soundList.append('<option value ="noSelection"> Select from below : </option>');
				$.each(vals, function (index, value){
					$soundList.append('<option value ='+value+'>' + value + '</option>');
				});
     	
			});
	    
	    	showDialog();
	    }
	    
	    function selectFile(){
	    var selectedFile = document.getElementById("fileSelection");
	    var selectedValue = selectedFile.options[selectedFile.selectedIndex].value;
	    
	    	if(selectedValue.localeCompare('noSelection') == 0){
	        
	    	}
	    	else{
	    	//alert('file selected!');
	    	document.getElementById("myDialog").close();
	    	
	    	obj.name = selectedValue; 
	    	drawSound = "/drawSound/";
	    	document.getElementById('audio').src = '';
	    	document.getElementById('fileName').innerHTML = obj.name;
	    	
	    	var audio = document.getElementById('audio');
	    	audio.src='/play/'+ obj.name;
	    	//audio.load();
	        
	    	$.get(audio.src,function(data, status){
	    		alert('get');
	     	    //alert(data.lastDate);
	     		
	    	document.getElementById('fileSize').innerHTML = formatSize(Number(data.length), 2);
	    	});
	    	document.getElementById('lastModifyDate').innerHTML = '';	
	
	    	
	    	getSoundInfo(); 

	    	}	
	    }
	    
	    </script>
	</head>











	<body>
     
              
	<Span id='above'>
	
			<audio id="audio" src="" preload="auto"></audio>
			
		    
			<!-- the vertical split line -->
			<div class="split"></div>
			<!-- the horizontal split line -->
			<div ><br> <br> </div> <hr >
			
			
			
			
			<!-- the upload button -->	
			<div class="uploadFile" data-toggle = "tooltip" title = "Upload a new sound file to start the analysis.">
			    <span  >Upload sound file </span>
			    <form id="myForm" enctype="multipart/form-data" method="post" action="/uploadSound">
			    <input id="upload" type="file" name="sound" accept="audio/*" />
			    </form>
			</div>
			
			
						
			
			<button class= "selectFromList" id = "selectFromList" onclick = "displayList()" data-toggle = "tooltip" title = "Select a sound file from the list.">Select from list</button>
			
				<!-- javascript for the upload button -->	
				<script>
			
				 
				$('#myForm').change(function() {
				    $(this).submit();
				});
				
				$('#myForm').ajaxForm(function() { 
				     alert("ajaxform"); 
				});
			
				
			
				</script>
			
			
		 	
		    <button  type = "button" onclick="alert('Add Script!')" class= "Script" data-toggle = "tooltip" title = "Upload own Script.">Open Script </button>
		 	
		 	
		 	<p id = "fileNameText">File name : </p>
		 	<p id = "fileName"></p>
		 	
		 	<p id = "fileSizeText">File size : </p>
		 	<p id = "fileSize"></p>
		 	
		 	<p id = "lastModifyDateText">Last modify date : </p>
		 	<p id = "lastModifyDate"></p>
		 	
		 	<p id = "timeDurationText">Time duration : </p>
		 	<p id = "timeDuration"></p>
		 
		<div id = "leftMenuBar" >
			<!-- the side menus -->	
			<div  class = "menu">
			    <!--<button class= "play" onclick="play()" data-toggle = "tooltip" title = "Play the selected sound file."> Play </button>-->
			    <button class= "mainmenu">Sound</button>
			    	<div class = "drop-content">
			    		<a href = "javascript:void(0)"  onclick = "play()" >&nbsp; Play </a>
			    		<a href = "javascript:void(0)" onclick = "getEnergy()">&nbsp; Get energy...  </a>
			    		
			    	</div>
			</div>
			<br><br>

			<div  class = "menu" >	
			 	<button class= "mainmenu">Pitch</button>
			 	<div class = "drop-content">
			 		<a href = "javascript:void(0)"  onclick = "getPitch()">&nbsp; Get pitch </a>
			 		<a href = "javascript:void(0)" onclick = "countvf()">&nbsp; Count voiced frames  </a>
			 		<a href = "javascript:void(0)" onclick = "getvat()">&nbsp; Get value at time...</a>
			 		<a href = "javascript:void(0)" onclick = "getvif()">&nbsp; Get value in frame... </a>
			 	</div>
			</div>
			<br><br>
			
			<div  class = "menu" >	
			 	<button class= "mainmenu">Spectrum</button>
			 	<div class = "drop-content">
			 		<a href = "javascript:void(0)" onclick = "getlf()">&nbsp; Get lowest frequency  </a>
			 		<a href = "javascript:void(0)" onclick = "gethf()">&nbsp; Get highest frequency </a>
			 	</div>
			</div>
			<br><br>
			
			
			<div  class = "menu">	
			 	<button class= "mainmenu"> Intensity  </button>
			 	<div class = "drop-content">
			 		<a href = "javascript:void(0)" >&nbsp; Get intensity </a>
			 		<a href = "javascript:void(0)" >&nbsp; Get minimum intensity </a>
			 		<a href = "javascript:void(0)" >&nbsp; Get maximum intensity</a>
			 		<a href = "javascript:void(0)" >&nbsp; Get mean intensity </a>
			 	</div>
			</div>
			<br><br>
			
			
			<div  class = "menu" >	
			 	<button class= "mainmenu"> Formant </button>
			 	<div class = "drop-content">
			 		<a href = "javascript:void(0)" >&nbsp; Get formant </a>
			 		<a href = "javascript:void(0)" >&nbsp; Get number of frames</a>
			 		<a href = "javascript:void(0)" >&nbsp; Get numbers of formants...</a>
			 		<a href = "javascript:void(0)" >&nbsp; Get value at time... </a>
			 	</div>
			</div>
			<br><br>
			
			
			<div  class = "menu" >	
			 	<button class= "mainmenu"> Harmonicity  </button>
			 	<div class = "drop-content">
			 		<a href = "javascript:void(0)" >&nbsp; Get minimum... </a>
			 		<a href = "javascript:void(0)" >&nbsp; Get maximum...</a>
			 		<a href = "javascript:void(0)" >&nbsp; Get value at time... </a>
			 	</div>
			</div>
			<br><br>
			
			
			<div  class = "menu" >	
			 	<button class= "mainmenu"> PointProcess </button>
			 	<div class = "drop-content">
			 		<a href = "javascript:void(0)" >&nbsp; Get number of periods...  </a>
			 		<a href = "javascript:void(0)" >&nbsp; Get number of points...</a>
			 		<a href = "javascript:void(0)" >&nbsp; Get jitter (local)... </a>
			 	</div>
			</div>
		</div>
			<!-- IMAGE DISPLAY::  vertical lines and transbox inside the image   -->
			<div class="verticalLine" id = "line1"></div> 
			<div class="verticalLine" id = "line2"></div>
			<div class="transBox" id="transBox" > </div> 
			<br><br>	
	</Span>	
		
		<p id = "selectNewFile"> Select a new file to start the analysis. </p>
		<div class = "interactSection">
		    
			<img  src="img/0.png"  onmousedown="return false" alt="spectrum image" width="427" height="487"id = "target" />
			
			
		</div>
		
		<div  id = "showPitchRange"></div>
		
		
		<div  id = "showIntensityRange"></div>
		
		<div id = "blockTimes">
		&nbsp;
		</div>
		
		<div id = "showTimesLeft"></div>
		
		<div id = "showTimesRight"></div>
		
		<div id = "showHz"></div>
		
		<div id = "hzLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div>
		
			<br><br>
	<Span id='below'>

		<br><br>
		
		
		
		<input type='button' value='Print'  class = "printbox" onclick="window.print()"data-toggle = "tooltip" title = "Print the analyzed outcome.">
					    
		<!-- the checkboxes --> 
		<div id = "checkboxes">	
			<input  id="spectrogram" type="checkbox" value = "spectrogram" checked> Spectrogram<br>
			<input  id="pitch" type="checkbox" value = "Pitch" checked> Pitch<br>
			<input  id="intensity" type="checkbox" value = "intensity" checked> Intensity<br>
			<input  id="formant" type="checkbox" value = "formant" checked> Formant<br>
			<input  id="pointprocess" type="checkbox" value = "pointprocess"> Pulses<br>
			
	    </div>
			
		<!-- the buttons -->
		<button type = "button" onclick="save()" id = "Save" data-toggle = "tooltip" title = "Save the result of your analysis.">Save </button>
		<button type = "button"  class = "bottomButton" id = "all" data-toggle = "tooltip" data-placement="auto top" title = "Display the whole spectrogram.">all </button>
		<button type = "button"  class = "bottomButton" id = "in" data-toggle = "tooltip" data-placement="top" title = "Zoom in the spectrogram.">zoom in </button>
		<button type = "button"  class = "bottomButton" id = "out" data-toggle = "tooltip" data-placement="top" title = "Zoom out of the spectrogram.">zoom out </button>
		<button type = "button"  class = "bottomButton" id = "sel" data-toggle = "tooltip" data-placement="top" title = "Display the specific selected time range.">selection </button>
		
		
		
		<div id = "timeLabel">
			<p id = "info"></p>
		</div>
		
		<div id = "otherSource">
		<p> Other Sources: </p>
		</div>
		
		<div id ="sourceLink">
		<a  class = "source" href = "https://bitbucket.org/ashiksmd/peldaws"> Source Code Access </a>
		</div>	
		<div id ="peldaLink">
		<a  class = "source" href = "#">Audio Retrieval and Version Control </a>
		</div>
		<div id ="deeplearningLink">
		<a  class = "source" href = "#">Deep learning </a>
		</div>
		<div id = "selTimeLabel">
			<p id = "selectedInfo"></p>
		</div> 
		
		<dialog id="myDialog"  >
		<h2 id = "selectAFile"> &nbsp;&nbsp;Select a file:</h2>
			<br>
			<select id = "fileSelection" style="font-size: 24px;"  >
				 
			</select>
			<button  id = "close" onclick="closeDialog()" >Close</button>
			<button  id = "select" onclick = "selectFile()" >Select</button>
		</dialog>
		<script>
		var x = document.getElementById("myDialog"); 
		
		function showDialog(){
		    x.show();
		}
		function closeDialog(){ 
		    x.close(); 
		}
		</script>
		
		
	</Span>
		
	
				
	</body>
</html>